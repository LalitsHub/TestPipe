using System;
using System.Data.SqlClient;

namespace AgVueAutomation.lib
{
    class databaseLib
    {
        public static Boolean setupTestdata ()
        {
            Boolean boolRet = true;
            string userId = "p3aqk";
            string insertCmd = "BEGIN DECLARE @RateId INT, @AttribCatId INT, @RatDetlId INT, @AttribSubCatId INT INSERT INTO [Rate].[ProgramType]([ProgramTypeCode],[GroupCode],[ProgramDesc],[AssociationCode], [ModifiedBy]) VALUES (@programTypeCode, 'FCE', @programDescription, NULL, @userId) INSERT INTO [Rate].[RateConfig]([GroupCode],[AssociationCode],[ProgramTypeCode],[ApplicationTypeCode],[RateDesc],[RateEffDate],[RateExpDate],[RateStatusCode],[ModifiedBy]) VALUES ('FCE', '', @programTypeCode, 'LO', @rateDescription, @rateEffectiveDate, NULL, 'A',@userId) SET @RateId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('New and Late Model Used Equipment � 10 Years or Less', @programTypeCode, 1, NULL, @userId) SET @AttribCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribCatId, 'EQUIPMENTAGE', '<=', '10', NULL, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '4.8',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=5 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '3', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '5', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '5',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=7 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '5', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '7', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '5.3',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.15',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=5 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '3', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '5', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.11',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=7 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId); INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '5', '&&', @userId); INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '7', NULL, @userId); INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.15',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Used Equipment � Between 11 and 25 Years', @programTypeCode, 1, NULL, @userId) SET @AttribCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribCatId, 'EQUIPMENTAGE', '>=', '11', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribCatId, 'EQUIPMENTAGE', '<=', '25', NULL, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '4.9',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=5 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '3', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '5', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '5.1',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=7 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '5', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '7', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '5.5',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.21',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=5 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '3', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '5', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.15',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=7 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '5', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '7', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.3',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Used Equipment � 26 Years and Greater', @programTypeCode, 1, NULL, @userId) SET @AttribCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribCatId, 'EQUIPMENTAGE', '>=', '26', NULL, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '5.7',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Rate Lock Add Factors', @programTypeCode, 1, NULL, @userId) SET @AttribCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('60-Day Lock', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOCKPERIOD', '==', '60', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'P', '0.05',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('90-Day Lock', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOCKPERIOD', '==', '90', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'P', '0.1',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Precision Ag & Telematics Program', @programTypeCode, 1, NULL, @userId) SET @AttribCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribCatId, 'EQUIPMENTTYPE', '==', 'PREAGTELE', NULL, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '4.65',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) END";
            try
            {
                using (SqlConnection conn = new SqlConnection())
                {
                    conn.ConnectionString = lib.generalLib.readjson("dbConnectionString");
                    conn.Open();
                    DateTime date1 = DateTime.Now;
                    date1 = date1.AddMonths(2);
                    string currDate = date1.ToString("yyyy-MM-dd");
                    currDate = currDate + " 00:00:00.000";
                    for (int i = 1; i <= 4; i++)
                    {
                        using (SqlCommand cmd = new SqlCommand(insertCmd, conn))
                        {
                            cmd.Parameters.AddWithValue("@userId", userId);
                            cmd.Parameters.AddWithValue("@programTypeCode", "AUT" + i);
                            cmd.Parameters.AddWithValue("@programDescription", "Automation" + i);
                            cmd.Parameters.AddWithValue("@rateDescription", "Automation Testdata" + i);
                            cmd.Parameters.AddWithValue("@rateEffectiveDate", currDate);                            
                            cmd.ExecuteNonQuery();
                            lib.resultUtil.AddResult("Setup Test data", "Should insert test data 'AUT" + i + "'", "Successfully inserted test data 'AUT" + i + "'", "PASS");
                        }
                    }
                    date1 = DateTime.Now;
                    date1 = date1.AddDays(-10);
                    string currDate1 = date1.ToString("yyyy-MM-dd");
                    currDate1 = currDate1 + " 00:00:00.000";

                    date1 = DateTime.Now;
                    date1 = date1.AddMonths(-1);
                    string currDate2 = date1.ToString("yyyy-MM-dd");
                    currDate2 = currDate2 + " 00:00:00.000";
                    //Creating AUT5 rate sheet with 10 days previous to current date
                    using (SqlCommand cmd = new SqlCommand(insertCmd, conn))
                    {
                        cmd.Parameters.AddWithValue("@userId", userId);
                        cmd.Parameters.AddWithValue("@programTypeCode", "AUT5");
                        cmd.Parameters.AddWithValue("@programDescription", "Automation5");
                        cmd.Parameters.AddWithValue("@rateDescription", "Automation Testdata5");
                        cmd.Parameters.AddWithValue("@rateEffectiveDate", currDate1);
                        cmd.ExecuteNonQuery();
                        lib.resultUtil.AddResult("Setup Test data", "Should insert test data 'AUT5'", "Successfully inserted test data 'AUT5'", "PASS");

                    }
                    //Creating AUT5 rate sheet with 10 days previous to current date
                    insertCmd = "BEGIN DECLARE @RateId INT, @AttribCatId INT, @RatDetlId INT, @AttribSubCatId INT INSERT INTO [Rate].[RateConfig]([GroupCode],[AssociationCode],[ProgramTypeCode],[ApplicationTypeCode],[RateDesc],[RateEffDate],[RateExpDate],[RateStatusCode],[ModifiedBy]) VALUES ('FCE', '', @programTypeCode, 'LO', @rateDescription, @rateEffectiveDate, NULL, 'A',@userId) SET @RateId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('New and Late Model Used Equipment � 10 Years or Less', @programTypeCode, 1, NULL, @userId) SET @AttribCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribCatId, 'EQUIPMENTAGE', '<=', '10', NULL, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '4.8',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=5 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '3', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '5', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '5',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=7 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '5', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '7', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '5.3',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.15',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=5 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '3', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '5', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.11',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=7 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId); INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '5', '&&', @userId); INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '7', NULL, @userId); INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.15',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Used Equipment � Between 11 and 25 Years', @programTypeCode, 1, NULL, @userId) SET @AttribCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribCatId, 'EQUIPMENTAGE', '>=', '11', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribCatId, 'EQUIPMENTAGE', '<=', '25', NULL, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '4.9',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=5 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '3', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '5', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '5.1',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=7 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '5', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '7', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '5.5',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.21',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=5 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '3', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '5', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.15',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Power Up Rate >= 75K Loan Term <=7 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOANAMOUNT', '>=', '75000', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '>', '5', '&&', @userId) INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '7', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'D', '0.3',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Used Equipment � 26 Years and Greater', @programTypeCode, 1, NULL, @userId) SET @AttribCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribCatId, 'EQUIPMENTAGE', '>=', '26', NULL, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '5.7',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Rate Lock Add Factors', @programTypeCode, 1, NULL, @userId) SET @AttribCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('60-Day Lock', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOCKPERIOD', '==', '60', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'P', '0.05',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('90-Day Lock', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'LOCKPERIOD', '==', '90', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'P', '0.1',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Precision Ag & Telematics Program', @programTypeCode, 1, NULL, @userId) SET @AttribCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribCatId, 'EQUIPMENTTYPE', '==', 'PREAGTELE', NULL, @userId) INSERT INTO [Rate].[AttributeCategory]([AttributeCatDesc],[ProgramTypeCode],[CatLevel],[ParentAttributeCatID],[ModifiedBy]) VALUES ('Loan Term <=3 Years', @programTypeCode, 1, @AttribCatId, @userId) SET @AttribSubCatId = SCOPE_IDENTITY() INSERT INTO [Rate].[AttributeCategoryDetail]([AttributeCatID],[FieldCode],[FieldOp],[FieldValue],[ConditionalOp],[ModifiedBy]) VALUES (@AttribSubCatId, 'TERM', '<=', '3', NULL, @userId) INSERT INTO [Rate].[RateConfigDetail]([RateID],[AttributeTypeCode],[AttributeValue],[ModifiedBy]) VALUES (@RateId, 'B', '4.65',@userId) SET @RatDetlId = SCOPE_IDENTITY() INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribCatId, 1, @userId) INSERT INTO [Rate].[RateConfigDetailCategory]([RateDetailID],[AttributeCatID],[CatLevel],[ModifiedBy]) VALUES (@RatDetlId, @AttribSubCatId, 2, @userId) END";
                    using (SqlCommand cmd = new SqlCommand(insertCmd, conn))
                    {
                        cmd.Parameters.AddWithValue("@userId", userId);
                        cmd.Parameters.AddWithValue("@programTypeCode", "AUT5");
                        cmd.Parameters.AddWithValue("@programDescription", "Automation5");
                        cmd.Parameters.AddWithValue("@rateDescription", "Automation Testdata5");
                        cmd.Parameters.AddWithValue("@rateEffectiveDate", currDate2);
                        cmd.ExecuteNonQuery();
                        lib.resultUtil.AddResult("Setup Test data", "Should insert test data 'AUT5'", "Successfully inserted test data 'AUT5'", "PASS");
                    }
                    conn.Close();
                    conn.Dispose();
                }
            }
            catch (Exception e)
            {
                lib.resultUtil.AddResult("Setup Test data", "Automation test data should be loaded to Database", "EXCEPTION: " + e, "FAIL");
                boolRet = false;
            }
            return boolRet;
        }

        public static Boolean deleteTestdata()
        {
            Boolean boolRet = true;
            int rateId = 0;
            string deleteCmd = "BEGIN DECLARE @RateId INT DECLARE @AttributeCat TABLE (AttributCatId INT) SET @RateId = DATA1 INSERT INTO @AttributeCat SELECT DISTINCT AttributeCatID FROM Rate.RateConfigDetailCategory WHERE RateDetailID IN (SELECT RateDetailID FROM Rate.RateConfigDetail WHERE RateID = @RateId) DELETE FROM Rate.RateConfigDetailCategory WHERE RateDetailID in (SELECT RateDetailID FROM Rate.RateConfigDetail WHERE RateID = @RateId) DELETE FROM Rate.AttributeCategoryDetail WHERE AttributeCatID in (SELECT AttributCatId FROM @AttributeCat) DELETE FROM Rate.AttributeCategory WHERE AttributeCatID in (SELECT AttributCatId FROM @AttributeCat) DELETE FROM Rate.RateConfigDetail WHERE RateID =@RateId DELETE FROM Rate.RateAction WHERE RateID =@RateId DELETE FROM Rate.RateConfig WHERE RateID =@RateId DELETE FROM Rate.ProgramType WHERE ProgramTypeCode=DATA2 END";
            string searchCmd = "SELECT RateID FROM Rate.RateConfig WHERE ProgramTypeCode=@programTypeCode";
            string cmd1, cmd2;
            try
            {
                using (SqlConnection conn = new SqlConnection())
                {
                    conn.ConnectionString = lib.generalLib.readjson("dbConnectionString");
                    conn.Open();
                    for (int i = 1; i <= 5; i++)
                    {
                        SqlCommand cmd = new SqlCommand(searchCmd, conn);
                        cmd.Parameters.AddWithValue("@programTypeCode", "AUT"+i);
                        using (SqlDataReader dataReader = cmd.ExecuteReader())
                        {
                            if (dataReader.HasRows)
                            {
                                while (dataReader.Read())
                                {
                                    rateId = dataReader.GetInt32(0);
                                    cmd1 = deleteCmd.Replace("DATA1", rateId.ToString());
                                    cmd2 = cmd1.Replace("DATA2", "'AUT"+i+"'");
                                    using (SqlConnection conn1 = new SqlConnection())
                                    {
                                        conn1.ConnectionString = lib.generalLib.readjson("dbConnectionString");
                                        conn1.Open();
                                        using (SqlCommand cmd3 = new SqlCommand(cmd2, conn1))
                                        {
                                            cmd3.ExecuteNonQuery();
                                            lib.resultUtil.AddResult("Delete Test data", "Should delete test data from Database", "Test data 'AUT" + i + "' with rate id = " + rateId + " deleted from database", "PASS");
                                        }
                                        conn1.Close();
                                        conn1.Dispose();
                                    }
                                }
                            }
                            else
                            {
                                lib.resultUtil.AddResult("Delete Test data", "Should delete test data 'AUT" + i + "' from Database", "No records found for test data 'AUT"+ i + "' in database", "PASS");
                            }
                        }
                    }
                    conn.Close();
                    conn.Dispose();
                }
            }
            catch (Exception e)
            {
                lib.resultUtil.AddResult("Delete Test data", "Automation test data should be deleted from Database", "EXCEPTION: " + e, "FAIL");
                boolRet = false;
            }
            return boolRet;
        }
     }
}
